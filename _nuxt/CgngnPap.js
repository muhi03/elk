import{f as q,g as G,h as O,i as J,j as K,_ as Q}from"./e52vDK1b.js";import{d as D,bE as Z,c as N,V as tt,l as et,n as st,e as v,o as s,f as i,g as c,h as t,q as d,aY as at,a0 as nt,aX as ot,_ as F,r as p,t as h,G as L,p as o,bz as rt,cW as it,x as W,j as ct,A as T,s as C,cX as ut,i as lt,cY as V,aa as dt,bS as mt,ax as pt,H as B,I as _t,v as ft,a9 as H,aT as vt,cn as yt,bb as bt}from"./DsX_WIiI.js";import{_ as ht}from"./C6eokYE3.js";import{_ as gt}from"./CeHFxdYu.js";import{a as $t,s as kt,b as wt,c as xt}from"./nlvPIzJJ.js";import{u as I}from"./Bk2deyDc.js";import"./B99jxVQf.js";import"./CziPTEgh.js";import"./Bcq4IE-j.js";import"./DCTAFnlV.js";import"./CV_MCSxE.js";import"./CbHt1iDe.js";import"./C6-BcE6I.js";import"./BvzeSaDt.js";import"./CMW9HLv_.js";import"./Cm-GyKAJ.js";import"./BlWcp1Wq.js";import"./DdYSMCsR.js";import"./CGdQswpo.js";import"./CRBAsHgp.js";import"./zmBmm41-.js";const St=["id","lang"],At={flex:"~ gap-1","items-center":"","text-secondary":"","text-sm":""},Ct={flex:""},Nt={ms1:"","font-bold":"","cursor-pointer":""},Rt={key:0,"aria-hidden":"true"},Dt={key:1},Et={key:2},Tt={border:"t base","py-2":""},Vt=D({__name:"StatusDetails",props:{status:{},newer:{},command:{type:Boolean},actions:{type:Boolean,default:!0}},emits:["refetchStatus"],setup(g){const r=Z(g,["actions"]),e=N(()=>r.status.reblog&&r.status.reblog?r.status.reblog:r.status),u=tt(e.value.createdAt),{t:a}=et();return st({title:()=>`${rt(e.value.account)} ${a("common.in")} ${a("app_name")}: "${it(e.value.content)||""}"`}),(n,_)=>{const R=q,m=nt,f=at,$=F,w=G,k=O,x=J,S=K;return s(),v("div",{id:`status-${t(e).id}`,flex:"","flex-col":"","gap-2":"",pt2:"",pb1:"","ps-3":"","pe-4":"",relative:"",lang:t(e).language??void 0,"aria-roledescription":"status-details"},[i(R,{status:t(e),details:!0,absolute:"","inset-ie-2":"","top-2":"",onAfterEdit:_[0]||(_[0]=y=>n.$emit("refetchStatus"))},null,8,["status"]),i($,{to:("getAccountRoute"in n?n.getAccountRoute:t(ot))(t(e).account),"rounded-full":"","hover:bg-active":"","transition-100":"",pe5:"","me-a":""},{default:d(()=>[i(f,{account:t(e).account},{default:d(()=>[i(m,{account:t(e).account},null,8,["account"])]),_:1},8,["account"])]),_:1},8,["to"]),i(w,{status:t(e),newer:n.newer,context:"details"},null,8,["status","newer"]),c("div",At,[c("div",Ct,[c("div",null,h(t(u)),1),i(k,{status:t(e),inline:!1},{default:d(()=>[c("span",Nt,h(n.$t("state.edited")),1)]),_:1},8,["status"])]),_[1]||(_[1]=c("div",{"aria-hidden":"true"}," Â· ",-1)),i(x,{status:t(e)},null,8,["status"]),t(e).application?.name?(s(),v("div",Rt," Â· ")):p("",!0),t(e).application?.website&&t(e).application.name?(s(),v("div",Dt,[i($,{to:t(e).application.website},{default:d(()=>[L(h(t(e).application.name),1)]),_:1},8,["to"])])):t(e).application?.name?(s(),v("div",Et,h(t(e).application?.name),1)):p("",!0)]),c("div",Tt,[n.actions?(s(),o(S,{key:0,status:t(e),details:"",command:n.command},null,8,["status","command"])):p("",!0)])],8,St)}}}),Bt={flex:"~ col center gap2"},Ht={"btn-solid":"",flex:"~ center gap-2","text-sm":"",px2:"",py1:""},It=D({__name:"StatusNotFound",props:{account:{},status:{}},setup(g){const r=N(()=>{const[e,u]=g.account.split("@"),a=u||W.value?.server;return a?`https://${a}/@${e}/${g.status}`:null});return(e,u)=>{const a=F,n=gt;return s(),o(n,null,{default:d(()=>[c("div",Bt,[c("div",null,h(e.$t("error.status_not_found")),1),t(r)?(s(),o(a,{key:0,to:t(r),external:"",target:"_blank"},{default:d(()=>[c("button",Ht,[u[0]||(u[0]=c("div",{"i-ri:arrow-right-up-line":""},null,-1)),L(" "+h(e.$t("status.try_original_site")),1)])]),_:1},8,["to"])):p("",!0)])]),_:1})}}}),Ft={key:0,"xl:mt-4":"",mb:"50vh",border:"b base"},oe=D({__name:"[status]",setup(g){const r=ct(),e=N(()=>r.params.status),u=T(null),{data:a,pending:n,refresh:_}=I(`status:${e.value}`,()=>ut(e.value,!0),{watch:[C],immediate:C.value,default:()=>H()}),{client:R}=lt(),{data:m,pending:f,refresh:$}=I(`context:${e.value}`,async()=>R.value.v1.statuses.$select(e.value).context.fetch(),{watch:[C],immediate:C.value,lazy:!0,default:()=>H()});f&&V(f,w),n&&V(n,w);async function w(){await vt();const y=yt(u);y&&y.scrollIntoView(!0)}const k=T();function x(){return k.value?.focusEditor?.()}bt("focus-editor",x),dt(k,()=>{window.history.state.focusReply&&x()});const S=N(()=>a.value?mt(a.value):null);return pt(()=>{_(),$()}),(y,A)=>{const E=Q,M=Vt,P=ht,U=It,z=wt,j=xt,X=ft;return s(),o(X,{back:""},{default:d(()=>[t(n)?(s(),o(z,{key:1,border:"b base"})):(s(),v(B,{key:0},[t(a)?(s(),v("div",Ft,[t(f)?p("",!0):(s(!0),v(B,{key:0},_t(t(m)?.ancestors,(l,b)=>(s(),o(E,{key:l.id,status:l,actions:l.visibility!=="direct",context:"account","has-older":!0,newer:t(m)?.ancestors[b-1]},null,8,["status","actions","newer"]))),128)),i(M,{ref_key:"main",ref:u,status:t(a),newer:t(m)?.ancestors.at(-1),command:"",style:{"scroll-margin-top":"60px"},onRefetchStatus:A[0]||(A[0]=l=>t(_)())},null,8,["status","newer"]),("currentUser"in y?y.currentUser:t(W))?(s(),o(P,{key:1,ref_key:"publishWidget",ref:k,class:"border-y border-base","draft-key":t(S).key,initial:t(S).draft,onPublished:A[1]||(A[1]=l=>t($)())},null,8,["draft-key","initial"])):p("",!0),t(f)?p("",!0):(s(),o(t($t),{key:2,items:t(m)?.descendants||[],"min-item-size":200,buffer:800,"key-field":"id","page-mode":""},{default:d(({item:l,index:b,active:Y})=>[i(t(kt),{item:l,active:Y},{default:d(()=>[(s(),o(E,{key:l.id,status:l,context:"account",older:t(m)?.descendants[b+1],newer:b>0?t(m)?.descendants[b-1]:t(a),"has-newer":b===0,main:t(a)},null,8,["status","older","newer","has-newer","main"]))]),_:2},1032,["item","active"])]),_:1},8,["items"]))])):(s(),o(U,{key:1,account:t(r).params.account,status:t(e)},null,8,["account","status"]))],64)),t(n)||t(f)?(s(),o(j,{key:2})):p("",!0)]),_:1})}}});export{oe as default};
