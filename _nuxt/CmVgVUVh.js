import{d as H,aj as Y,ak as Z,l as K,a as q,A as p,aT as f,E as F,e as v,o as r,g as e,p as h,r as T,h as t,a2 as z,as as A,q as c,at as G,bt as I,_ as ee,G as P,t as y,f as L,H as U,a5 as D,Q,bN as te,n as oe,c as ie,a4 as re}from"./DsX_WIiI.js";import{_ as J}from"./BvzeSaDt.js";import{u as ne}from"./ZqafHVTr.js";import{_ as se}from"./nlvPIzJJ.js";const le=["aria-describedby"],ae={key:0,"bg-base":"",border:"~ base",h10:"",m2:"","ps-1":"","pe-4":"","rounded-3":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},de={mr4:"",flex:"",gap2:""},ue=["disabled"],ce={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},pe={key:1,block:"","text-current":"","i-ri:save-2-fill":"",class:"rtl-flip"},fe=["disabled"],me={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},be={key:1,block:"","text-current":"","i-ri:delete-bin-2-line":"",class:"rtl-flip"},ve=["id"],_e={flex:"","items-center":"","gap-x-2":"","font-bold":""},ye=["aria-label"],ge={"ps-2":"","sm:ps-1":""},he={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},ke={"sr-only":""},xe=H({__name:"ListEntry",props:{modelValue:{required:!0},modelModifiers:{}},emits:Y(["listUpdated","listRemoved"],["update:modelValue"]),setup(S,{emit:N}){const V=N,l=Z(S,"modelValue"),{t:m}=K(),k=q(),{form:n,isDirty:g,submitter:_,reset:M}=ne({form:()=>({...l.value})}),a=p(!1),b=p(!1),d=p(void 0),x=p(),i=p(),s=p();async function j(){a.value=!0,d.value=void 0,await f(),x.value?.focus()}async function $(){a.value=!1,d.value=void 0,await f(),M(),i.value?.focus()}const{submit:R,submitting:B}=_(async()=>{try{l.value=await k.v1.lists.$select(n.id).update({title:n.title}),$()}catch(u){d.value=u.message,await f(),x.value?.focus()}});async function w(){if(b.value)return;const u=await te({title:m("confirm.delete_list.title"),description:m("confirm.delete_list.description",[l.value.title]),confirm:m("confirm.delete_list.confirm"),cancel:m("confirm.delete_list.cancel")});if(b.value=!0,d.value=void 0,await f(),u.choice==="confirm"){await f();try{await k.v1.lists.$select(l.value.id).remove(),V("listRemoved",l.value.id)}catch(o){d.value=o.message,await f(),s.value?.focus()}finally{b.value=!1}}else b.value=!1}async function O(){d.value=void 0,await f(),a.value?x.value?.focus():s.value?.focus()}return F($),(u,o)=>{const E=A,W=ee,X=J;return r(),v(U,null,[e("form",{"hover:bg-active":"",flex:"","justify-between":"","items-center":"","gap-x-2":"","aria-describedby":t(d)?`action-list-error-${l.value.id}`:void 0,class:Q(t(d)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:o[3]||(o[3]=D((...C)=>t(R)&&t(R)(...C),["prevent"]))},[t(a)?(r(),v("div",ae,[t(a)?(r(),h(E,{key:0,content:u.$t("list.cancel_edit")},{default:c(()=>[e("button",{type:"button","rounded-full":"","text-sm":"",p2:"","transition-colors":"","hover:text-primary":"",onClick:o[0]||(o[0]=C=>$())},o[4]||(o[4]=[e("span",{block:"","text-current":"","i-ri:close-fill":""},null,-1)]))]),_:1},8,["content"])):T("",!0),z(e("input",{ref_key:"input",ref:x,"onUpdate:modelValue":o[1]||(o[1]=C=>t(n).title=C),"rounded-3":"","w-full":"","bg-transparent":"",outline:"focus:none","pe-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",onKeydown:o[2]||(o[2]=I(C=>$(),["esc"]))},null,544),[[G,t(n).title]])])):(r(),h(W,{key:1,to:`list/${l.value.id}`,block:"",grow:"",p4:""},{default:c(()=>[P(y(t(n).title),1)]),_:1},8,["to"])),e("div",de,[t(a)?(r(),h(E,{key:0,content:u.$t("list.save")},{default:c(()=>[e("button",{type:"submit","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(b)||!t(g)||t(B)},[t(a)?(r(),v(U,{key:0},[t(B)?(r(),v("span",ce,o[5]||(o[5]=[e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1)]))):(r(),v("span",pe))],64)):T("",!0)],8,ue)]),_:1},8,["content"])):(r(),h(E,{key:1,content:u.$t("list.edit")},{default:c(()=>[e("button",{ref_key:"editBtn",ref:i,type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",onClick:D(j,["prevent"])},o[6]||(o[6]=[e("span",{block:"","text-current":"","i-ri:edit-2-line":"",class:"rtl-flip"},null,-1)]),512)]),_:1},8,["content"])),L(E,{content:u.$t("list.delete")},{default:c(()=>[e("button",{type:"button","text-sm":"",p2:"","border-1":"","transition-colors":"","border-dark":"","hover:text-primary":"","btn-action-icon":"",disabled:t(a),onClick:D(w,["prevent"])},[t(b)?(r(),v("span",me,o[7]||(o[7]=[e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1)]))):(r(),v("span",be))],8,fe)]),_:1},8,["content"])])],42,le),t(d)?(r(),h(X,{key:0,id:`action-list-error-${l.value.id}`,"described-by":`action-list-failed-${l.value.id}`,class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:c(()=>[e("header",{id:`action-list-failed-${l.value.id}`,flex:"","justify-between":""},[e("div",_e,[o[8]||(o[8]=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1)),e("p",null,y(u.$t(`list.${t(a)?"edit_error":"delete_error"}`)),1)]),L(E,{placement:"bottom",content:u.$t("list.clear_error")},{default:c(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":u.$t("list.clear_error"),onClick:O},o[9]||(o[9]=[e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1)]),8,ye)]),_:1},8,["content"])],8,ve),e("ol",ge,[e("li",he,[e("strong",ke,y(u.$t("list.error_prefix")),1),e("span",null,y(t(d)),1)])])]),_:1},8,["id","described-by"])):T("",!0)],64)}}}),$e=["aria-describedby"],we={"bg-base":"",border:"~ base","flex-1":"",h10:"","ps-1":"","pe-4":"","rounded-2":"","w-full":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":"","gap-3":""},Ee=["placeholder"],Ce={flex:"~ col","gap-y-4":"","gap-x-2":"",sm:"~ justify-between flex-row"},Ve=["disabled"],Me={key:0,"aria-hidden":"true",block:"",animate:"","animate-spin":"","preserve-3d":"",class:"rtl-flip"},Re={key:1,"aria-hidden":"true",block:"","i-material-symbols:playlist-add-rounded":"",class:"rtl-flip"},Be={id:"create-list-failed",flex:"","justify-between":""},Te={flex:"","items-center":"","gap-x-2":"","font-bold":""},De=["aria-label"],Le={"ps-2":"","sm:ps-1":""},Ne={flex:"~ col sm:row","gap-y-1":"","sm:gap-x-2":""},je={"sr-only":""},qe=H({__name:"index",setup(S){const{t:N}=K(),V=q(),l=V.v1.lists.list();oe({title:()=>N("nav.lists")});const m=p(),k=p(),n=p(void 0),g=p(!1),_=p(""),M=ie(()=>_.value.length>0);async function a(){if(!(g.value||!M.value)){g.value=!0,n.value=void 0,await f();try{const i=await V.v1.lists.create({title:_.value});m.value?.createEntry(i),_.value=""}catch(i){n.value=i.message,f(()=>{k.value?.focus()})}finally{g.value=!1}}}function b(i){n.value=void 0,i&&f(()=>{k.value?.focus()})}function d(i){m.value?.updateEntry(i)}function x(i){m.value?.removeEntry(i)}return F(()=>b(!1)),(i,s)=>{const j=xe,$=A,R=J,B=se;return r(),h(B,{ref_key:"paginatorRef",ref:m,paginator:t(l)},{default:c(({item:w})=>[L(j,{"model-value":w,"onUpdate:modelValue":d,onListRemoved:x},null,8,["model-value"])]),done:c(()=>[e("form",{border:"t base","p-4":"","w-full":"",flex:"~ wrap",relative:"","gap-3":"","aria-describedby":t(n)?"create-list-error":void 0,class:Q(t(n)?"border border-base border-rounded rounded-be-is-0 rounded-be-ie-0 border-b-unset border-$c-danger-active":null),onSubmit:D(a,["prevent"])},[e("div",we,[z(e("input",{ref_key:"inputRef",ref:k,"onUpdate:modelValue":s[0]||(s[0]=w=>re(_)?_.value=w:null),"bg-transparent":"",outline:"focus:none","px-4":"",pb:"1px","flex-1":"","placeholder-text-secondary":"",placeholder:i.$t("list.list_title_placeholder"),onKeypress:I(a,["enter"])},null,40,Ee),[[G,t(_)]])]),e("div",Ce,[e("button",{flex:"~ row","gap-x-2":"","items-center":"","btn-solid":"",disabled:!t(M)||t(g)},[t(g)?(r(),v("span",Me,s[2]||(s[2]=[e("span",{block:"","i-ri:loader-2-fill":"","aria-hidden":"true"},null,-1)]))):(r(),v("span",Re)),P(" "+y(i.$t("list.create")),1)],8,Ve)])],42,$e),t(n)?(r(),h(R,{key:0,id:"create-list-error","described-by":"create-list-failed",class:"rounded-bs-is-0 rounded-bs-ie-0 border-t-dashed m-b-2"},{default:c(()=>[e("header",Be,[e("div",Te,[s[3]||(s[3]=e("div",{"aria-hidden":"true","i-ri:error-warning-fill":""},null,-1)),e("p",null,y(i.$t("list.error")),1)]),L($,{placement:"bottom",content:i.$t("list.clear_error")},{default:c(()=>[e("button",{flex:"","rounded-4":"",p1:"","hover:bg-active":"","cursor-pointer":"","transition-100":"","aria-label":i.$t("list.clear_error"),onClick:s[1]||(s[1]=w=>b(!0))},s[4]||(s[4]=[e("span",{"aria-hidden":"true",w:"1.75em",h:"1.75em","i-ri:close-line":""},null,-1)]),8,De)]),_:1},8,["content"])]),e("ol",Le,[e("li",Ne,[e("strong",je,y(i.$t("list.error_prefix")),1),e("span",null,y(t(n)),1)])])]),_:1})):T("",!0)]),_:1},8,["paginator"])}}});export{qe as default};
