import{A as d,an as b,cB as q,c as m,aa as O,D as S}from"./DsX_WIiI.js";var U=Object.defineProperty,I=Object.defineProperties,R=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,C=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,h=(e,r,t)=>r in e?U(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,v=(e,r)=>{for(var t in r||(r={}))C.call(r,t)&&h(e,t,r[t]);if(_)for(var t of _(r))T.call(r,t)&&h(e,t,r[t]);return e},j=(e,r)=>I(e,R(r)),V=(e,r,t)=>new Promise((n,o)=>{var u=c=>{try{l(t.next(c))}catch(s){o(s)}},i=c=>{try{l(t.throw(c))}catch(s){o(s)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(u,i);l((t=t.apply(e,r)).next())}),z=e=>typeof e=="function";function p(e,r){return Object.prototype.hasOwnProperty.call(e,r)}var A=e=>e==null,P=e=>e instanceof Date,k=e=>typeof e=="object";function w(e){return A(e)||!k(e)}var B=e=>Promise.resolve(e)===e,N=e=>Object.keys(e).length===0;function x(e,r){return D(e,r)}function D(e,r,t=new WeakSet){if(w(e)||w(r))return{equal:e===r,pointersEqual:!1};let n=e===r;if(n||t.has(e))return{equal:n,pointersEqual:n};if(t.add(e),P(e)&&P(r))return{equal:e.getTime()===r.getTime(),pointersEqual:!1};const o=Object.keys(e),u=Object.keys(r);if(o.length!==u.length)return{equal:!1,pointersEqual:!1};for(const i of o){const l=e[i];if(!u.includes(i))return{equal:!1,pointersEqual:n};const c=r[i],s=D(l,c,t);if(!s.equal)return s;n||(n=s.pointersEqual)}return t.delete(e),{equal:!0,pointersEqual:n}}function H(e,r,t){const n=d(0),o=d(0),u=O(e,()=>{o.value++},j(v({},t),{flush:"sync"})),i=O(e,(...s)=>{const a=n.value>0&&n.value===o.value;n.value=0,o.value=0,a||r(...s)},t);return{ignoreUpdates:s=>{const a=o.value;s();const y=o.value-a;n.value+=y},ignorePrevAsyncUpdates:()=>{n.value=o.value},stop:()=>{u(),i()}}}function L(e,r,t,n,o,u){for(const i in r){if(!p(r,i))continue;const l=p(u,i)?u[i]:void 0;e[i]=b(v({message:n,isError:!1,isDirty:m(()=>!x(t.value[i],r[i]).equal)},M(i,e,r,n,o,l)))}}function M(e,r,t,n,o,u){function i(g,E=!0){r[e].message=g,r[e].isError=E}function l(){if(!u)return;const{message:g,valid:E}=u.validate(t[e],{fullResult:!0});i(g,!E)}let c=null;const s=()=>{!u||o||c||(c=S(l))},{ignoreUpdates:a}=H(()=>t[e],s,{deep:k(t[e])});function y(){c&&(c(),c=null),i(n,!1)}function f(){return l(),!r[e].isError}return{verify:f,setError:i,clearError:y,init:s,_ignoreUpdate:a}}function W(e,r){return m(()=>{const t={},n=Object.keys(e);for(const o of n)r[o].isDirty&&p(e,o)&&(t[o]=e[o]);return q(t)})}function G(e){return m(()=>{var r;const t=Object.keys(e);for(const n of t)if((r=e[n])!=null&&r.isError)return!0;return!1})}function J(e){return m(()=>!N(e.value))}function F(e,...r){return e(...r)}function K(e,r,t){const{enableVerify:n=!0}=t??{},{verify:o}=e,u=d(!1);return{submitting:u,submit:()=>{if(n&&!o())return;const l=r(e);return B(l)?F(()=>V(this,null,function*(){u.value=!0;try{return yield l}finally{u.value=!1}})):l}}}function Q(e){return(...r)=>K(e(),...r)}function X(e,r){const t={};for(const n in e){let o=function(i,l={}){const{fullResult:c}=l;for(const s of u||[]){const a=s(i);if(!a||typeof a=="string")return c?{valid:!1,message:a||r}:!1}return c?{valid:!0,message:r}:!0};const u=F(()=>{const i=e?.[n];return z(i)?[i]:i});t[n]={validate:o}}return t}var Y={defaultMessage:"",lazy:!1,fullValidation:!1};function ee(e){const r=Object.assign({},Y,e),{form:t,rule:n,defaultMessage:o,lazy:u,fullValidation:i}=r,l=d(t()),c=b(t()),s=X(n,o),a=b({});L(a,c,l,o,u,s);const y=W(c,a),f=v({form:c,status:q(a),dirtyFields:y,isDirty:J(y),isError:G(a)},Z(t,l,c,a,i));return j(v({},f),{rule:s,submitter:Q(()=>f)})}function Z(e,r,t,n,o){const u=()=>{let s=!0;return o?Object.keys(n).forEach(a=>{const y=n[a].verify();s=s&&y}):Object.keys(n).forEach(a=>{s=s&&n[a].verify()}),s};return{verify:u,clearErrors:()=>{Object.keys(n).forEach(s=>{n[s].clearError()})},reset:(...s)=>{r.value=e();const a=e(),y=f=>s.length===0||s.includes(f);for(const f in t)y(f)&&p(t,f)&&(p(a,f)?(n[f]._ignoreUpdate(()=>{t[f]=a[f]}),n[f].clearError()):delete t[f])},onSubmit:s=>u()?s():null}}export{ee as u};
