const h=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),b=h?Promise.resolve().then(function(){return _}):Promise.resolve().then(function(){return T});async function j(...e){return(await b).default(...e)}h?Promise.resolve().then(function(){return A}):Promise.resolve().then(function(){return S});h?Promise.resolve().then(function(){return x}):Promise.resolve().then(function(){return R});const P=async e=>{const n=await e.getFile();return n.handle=e,n};var k=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const n=[];e.forEach((o,a)=>{n[a]={description:o.description||"Files",accept:{}},o.mimeTypes?o.mimeTypes.map(i=>{n[a].accept[i]=o.extensions||[]}):n[a].accept["*/*"]=o.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:n,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),t=await Promise.all(r.map(P));return e[0].multiple?t:t[0]},_={__proto__:null,default:k};function m(e){function n(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var t=r.done;return Promise.resolve(r.value).then(function(o){return{value:o,done:t}})}return m=function(r){this.s=r,this.n=r.next},m.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var t=this.s.return;return t===void 0?Promise.resolve({value:r,done:!0}):n(t.apply(this.s,arguments))},throw:function(r){var t=this.s.return;return t===void 0?Promise.reject(r):n(t.apply(this.s,arguments))}},new m(e)}const v=async(e,n,r=e.name,t)=>{const o=[],a=[];var i,s=!1,l=!1;try{for(var u,p=function(c){var d,f,y,w=2;for(typeof Symbol<"u"&&(f=Symbol.asyncIterator,y=Symbol.iterator);w--;){if(f&&(d=c[f])!=null)return d.call(c);if(y&&(d=c[y])!=null)return new m(d.call(c));f="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());s=!(u=await p.next()).done;s=!1){const c=u.value,d=`${r}/${c.name}`;c.kind==="file"?a.push(c.getFile().then(f=>(f.directoryHandle=e,f.handle=c,Object.defineProperty(f,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>d})))):c.kind!=="directory"||!n||t&&t(c)||o.push(v(c,n,d,t))}}catch(c){l=!0,i=c}finally{try{s&&p.return!=null&&await p.return()}finally{if(l)throw i}}return[...(await Promise.all(o)).flat(),...await Promise.all(a)]};var g=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const n=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await n.values()).next()).done?[n]:v(n,e.recursive,void 0,e.skipDirectory)},A={__proto__:null,default:g},E=async(e,n=[{}],r=null,t=!1,o=null)=>{Array.isArray(n)||(n=[n]),n[0].fileName=n[0].fileName||"Untitled";const a=[];let i=null;if(e instanceof Blob&&e.type?i=e.type:e.headers&&e.headers.get("content-type")&&(i=e.headers.get("content-type")),n.forEach((u,p)=>{a[p]={description:u.description||"Files",accept:{}},u.mimeTypes?(p===0&&i&&u.mimeTypes.push(i),u.mimeTypes.map(c=>{a[p].accept[c]=u.extensions||[]})):i?a[p].accept[i]=u.extensions||[]:a[p].accept["*/*"]=u.extensions||[]}),r)try{await r.getFile()}catch(u){if(r=null,t)throw u}const s=r||await window.showSaveFilePicker({suggestedName:n[0].fileName,id:n[0].id,startIn:n[0].startIn,types:a,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1});!r&&o&&o(s);const l=await s.createWritable();return"stream"in e?(await e.stream().pipeTo(l),s):"body"in e?(await e.body.pipeTo(l),s):(await l.write(await e),await l.close(),s)},x={__proto__:null,default:E},L=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((n,r)=>{const t=document.createElement("input");t.type="file";const o=[...e.map(l=>l.mimeTypes||[]),...e.map(l=>l.extensions||[])].join();t.multiple=e[0].multiple||!1,t.accept=o||"",t.style.display="none",document.body.append(t);const a=l=>{typeof i=="function"&&i(),n(l)},i=e[0].legacySetup&&e[0].legacySetup(a,()=>i(r),t),s=()=>{window.removeEventListener("focus",s),t.remove()};t.addEventListener("click",()=>{window.addEventListener("focus",s)}),t.addEventListener("change",()=>{window.removeEventListener("focus",s),t.remove(),a(t.multiple?Array.from(t.files):t.files[0])}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),T={__proto__:null,default:L},O=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((n,r)=>{const t=document.createElement("input");t.type="file",t.webkitdirectory=!0;const o=i=>{typeof a=="function"&&a(),n(i)},a=e[0].legacySetup&&e[0].legacySetup(o,()=>a(r),t);t.addEventListener("change",()=>{let i=Array.from(t.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(i=i.filter(s=>s.webkitRelativePath.split("/").every(l=>!e[0].skipDirectory({name:l,kind:"directory"})))):i=i.filter(s=>s.webkitRelativePath.split("/").length===2),o(i)}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),S={__proto__:null,default:O},I=async(e,n={})=>{Array.isArray(n)&&(n=n[0]);const r=document.createElement("a");let t=e;"body"in e&&(t=await async function(i,s){const l=i.getReader(),u=new ReadableStream({start:d=>async function f(){return l.read().then(({done:y,value:w})=>{if(!y)return d.enqueue(w),f();d.close()})}()}),p=new Response(u),c=await p.blob();return l.releaseLock(),new Blob([c],{type:s})}(e.body,e.headers.get("content-type"))),r.download=n.fileName||"Untitled",r.href=URL.createObjectURL(await t);const o=()=>{typeof a=="function"&&a()},a=n.legacySetup&&n.legacySetup(o,()=>a(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),o()}),r.click(),null},R={__proto__:null,default:I};export{j as n};
