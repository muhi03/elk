import{_ as E}from"./CUkVP4aJ.js";import{d as $,e as l,o as t,f as _,g as u,aL as H,p as i,r as b,ay as K,az as q,aB as F,aC as M,q as W,Q as V,A as y,l as G,k as Q,cG as T,c as U,aa as j,a2 as J,at as O,h as s,bt as g,a5 as w,a4 as P,t as B,H as R,I as X}from"./vIUoIwJY.js";import{_ as Y}from"./v1qJ5AFC.js";import{_ as Z}from"./DGEeLdu4.js";import{u as ee,_ as te}from"./9uxXzJvs.js";const ne={flex:"","gap-2":"","items-center":""},se={flex:"~ col gap1",shrink:"","h-full":"","overflow-hidden":"","leading-none":""},oe={flex:"~","gap-2":""},ae=$({__name:"SearchAccountInfo",props:{account:{}},setup(S){return(a,e)=>{const p=H,m=K,v=q,f=F,o=M;return t(),l("div",ne,[_(p,{"w-10":"","h-10":"",account:a.account,"shrink-0":""},null,8,["account"]),u("div",se,[u("div",oe,[_(m,{account:a.account,"line-clamp-1":"","ws-pre-wrap":"","break-all":"","text-base":""},null,8,["account"]),a.account.locked?(t(),i(v,{key:0,"text-xs":""})):b("",!0),a.account.bot?(t(),i(f,{key:1,"text-xs":""})):b("",!0)]),_(o,{"text-sm":"",account:a.account,"text-secondary-light":""},null,8,["account"])])])}}}),re=$({__name:"SearchResult",props:{result:{},active:{type:Boolean}},setup(S){function a(){document.activeElement.blur()}return(e,p)=>{const m=E,v=ae,f=Y,o=Z;return t(),i(o,{as:"RouterLink","hover:bg-active":"",active:e.active,to:e.result.to,py2:"",block:"",px2:"","aria-selected":e.active,class:V({"bg-active":e.active}),onClick:p[0]||(p[0]=()=>a())},{default:W(()=>[e.result.type==="hashtag"?(t(),i(m,{key:0,hashtag:e.result.data},null,8,["hashtag"])):e.result.type==="account"?(t(),i(v,{key:1,account:e.result.data},null,8,["account"])):e.result.type==="status"?(t(),i(f,{key:2,status:e.result.data,actions:!1,"show-reply-to":!1},null,8,["status"])):b("",!0)]),_:1},8,["active","to","aria-selected","class"])}}}),ce={"bg-base":"",border:"~ base",h10:"","ps-4":"","pe-1":"","rounded-3":"",flex:"~ row","items-center":"",relative:"","focus-within:box-shadow-outline":""},le=["placeholder"],ue={"left-0":"","top-11":"",absolute:"","w-full":"","z-10":"","group-focus-within":"pointer-events-auto visible",invisible:"","pointer-events-none":""},ie={key:0,block:"","text-center":"","text-sm":"","text-secondary":""},pe={key:1,block:"","text-center":"","text-sm":"","text-secondary":""},de={key:2},ye=$({__name:"SearchWidget",setup(S,{expose:a}){const e=y(""),{accounts:p,hashtags:m,loading:v,statuses:f}=ee(e),o=y(0),{t:k}=G(),A=y(),h=y(),L=Q(),{focused:I}=T(A);a({input:h});const r=U(()=>e.value.length===0?[]:[...m.value.slice(0,3),...p.value,...f.value]);j([r,I],()=>o.value=-1);function C(d){return o.value=(o.value+d%r.value.length+r.value.length)%r.value.length}function N(){const d=o.value;if(e.value.length!==0){if(d===-1){o.value=0;return}document.activeElement.blur(),o.value=-1,L.push(r.value[d].to)}}return(d,n)=>{const z=re,x=te;return t(),l("div",{ref_key:"el",ref:A,relative:"",group:""},[u("div",ce,[n[6]||(n[6]=u("div",{"i-ri:search-2-line":"","pointer-events-none":"","text-secondary":"",mt:"1px",class:"rtl-flip"},null,-1)),J(u("input",{ref_key:"input",ref:h,"onUpdate:modelValue":n[0]||(n[0]=c=>P(e)?e.value=c:null),"h-full":"","rounded-3":"","w-full":"","bg-transparent":"",outline:"focus:none","ps-3":"","pe-1":"","ml-1":"",placeholder:s(k)("nav.search"),pb:"1px","placeholder-text-secondary":"",onKeydown:[n[1]||(n[1]=g(w(c=>C(1),["prevent"]),["down"])),n[2]||(n[2]=g(w(c=>C(-1),["prevent"]),["up"])),n[3]||(n[3]=g(w(c=>s(h)?.blur(),["prevent"]),["esc"]))],onKeypress:g(N,["enter"])},null,40,le),[[O,s(e)]]),s(e).length?(t(),l("button",{key:0,"btn-action-icon":"","text-secondary":"",onClick:n[4]||(n[4]=c=>{e.value="",s(h)?.focus()})},n[5]||(n[5]=[u("span",{"aria-hidden":"true",class:"i-ri:close-line"},null,-1)]))):b("",!0)]),u("div",ue,[u("div",{"w-full":"","bg-base":"",border:"~ base","rounded-3":"","max-h-100":"","overflow-auto":"",class:V(s(r).length===0?"py2":null)},[s(e).trim().length===0?(t(),l("span",ie,B(s(k)("search.search_desc")),1)):s(v)?(t(),l("div",de,[_(x),_(x),_(x)])):(t(),l(R,{key:1},[s(r).length>0?(t(!0),l(R,{key:0},X(s(r),(c,D)=>(t(),i(z,{key:c.id,active:s(o)===parseInt(D.toString()),result:c,tabindex:s(I)?0:-1},null,8,["active","result","tabindex"]))),128)):(t(),l("span",pe,B(s(k)("search.search_empty")),1))],64))],2)])],512)}}});export{ye as _,re as a};
